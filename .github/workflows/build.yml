name: ðŸ”¨ CI

on:
  push:
    branches: [main]
  pull_request:
    branches:
      - '**'

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ðŸ“¥ Checkout
      uses: actions/checkout@v6
      with:
        fetch-depth: 0

    - name: â˜• Set up JDK
      uses: actions/setup-java@v5
      with:
        distribution: temurin
        java-version: 25
        cache: maven

    - name: ðŸ”¨ Build with Maven
      run: ./mvnw clean install --file pom.xml -Ddiff.source="refs/remotes/origin/$GITHUB_BASE_REF" -e

    - name: ðŸ“¦ Expose Integration Tests Build Logs
      if: always()
      uses: actions/upload-artifact@master
      with:
        name: int-tests-artifacts
        path: |
          target/it/*/build.log
          target/it/*/target/site
